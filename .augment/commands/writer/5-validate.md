---
namespace: writer
name: 5-validate
description: 阶段五：合规性审查，对大纲进行四大维度的合规性检查
---

# 阶段五：合规性审查

## 命令说明

此命令用于执行阶段五的合规性审查工作，根据宪法文件的要求，对大纲进行四大维度的合规性检查。

## 用法

```bash
/writer:5-validate <project-dir>
```

### 参数

- `<project-dir>` (必需): 项目目录路径

### 示例

```bash
/writer:5-validate "D:\Projects\MyNovel"
```

## 前置条件

- 阶段四必须已完成（大纲编写）
- `.writer/outline/outline.md` 必须存在且已填写完整
- `.writer/constitution/constitution.md` 必须存在

## 执行步骤

1. **检查前置条件**
   - 验证阶段四已完成
   - 读取调研数据

2. **生成验证报告**
   - 使用模板 `templates/validation-report-template.md`
   - 自动填充项目信息

3. **保存文件**
   - 验证报告: `.writer/validation/validation-report.md`

4. **更新配置**
   - 更新 `config.json` 中的阶段五状态
   - 设置当前阶段为5

## 调用PowerShell脚本

```powershell
$scriptPath = "scripts/powershell/validate-outline.ps1"
& $scriptPath -ProjectDir "<project-dir>"
```

## 输出

### 成功输出

```
[完成] 验证报告已生成

项目信息:
  名称: 我的小说
  类型: 长篇小说
  验证报告: D:\Projects\MyNovel\.writer\validation\validation-report.md

需要检查的文档:
  大纲: D:\Projects\MyNovel\.writer\outline\outline.md
  宪法文件: D:\Projects\MyNovel\.writer\constitution\constitution.md

下一步行动:
  1. 打开验证报告: D:\Projects\MyNovel\.writer\validation\validation-report.md
  2. 打开大纲文档: D:\Projects\MyNovel\.writer\outline\outline.md
  3. 打开宪法文件: D:\Projects\MyNovel\.writer\constitution\constitution.md
  4. 对照宪法文件检查大纲的四大维度:
     - 主题一致性
     - 风格统一性
     - 逻辑连贯性
     - 架构完整性
  5. 在验证报告中记录所有问题
  6. 如果通过，运行: /writer:6-draft "D:\Projects\MyNovel" 1
  7. 如果不通过，修改大纲后重新验证

[注意] 请认真进行合规性审查
[注意] 只有通过审查才能进入阶段六
```

## 四大检查维度

### 1. 主题一致性检查

**检查项**:
- 每个章节都与核心主题相关
- 价值观表达与宪法文件一致
- 主题贯穿性

**检查方法**:
- 逐章检查与核心主题的关联
- 识别偏离主题的章节
- 验证价值观表达

### 2. 风格统一性检查

**检查项**:
- 叙事视角保持一致
- 语言风格符合要求
- 修辞手法符合规范

**检查方法**:
- 检查每章的叙事视角
- 验证风格描述的一致性
- 检查是否使用了禁止的修辞手法

### 3. 逻辑连贯性检查

**检查项**:
- 因果关系清晰
- 时间线一致
- 角色行为符合逻辑

**检查方法**:
- 分析重大事件的因果链
- 绘制时间线图
- 检查角色行为的合理性

### 4. 架构完整性检查

**检查项**:
- 章节结构完整
- 起承转合清晰
- 伏笔回收完整

**检查方法**:
- 验证必需章节是否齐全
- 检查结构的完整性
- 核对伏笔清单

## 验证报告结构

生成的验证报告包含以下部分：

1. **审查结果概览**
   - 总体状态（通过/不通过）
   - 问题统计
   - 四大维度检查结果

2. **主题一致性检查**
   - 核心主题贯穿性
   - 价值观一致性
   - 发现的问题（严重/轻微）

3. **风格统一性检查**
   - 叙事视角一致性
   - 语言风格一致性
   - 修辞手法一致性
   - 发现的问题

4. **逻辑连贯性检查**
   - 因果关系清晰性
   - 时间线一致性
   - 角色行为逻辑性
   - 发现的问题

5. **架构完整性检查**
   - 章节结构完整性
   - 起承转合清晰性
   - 伏笔回收完整性
   - 发现的问题

6. **问题汇总**
   - 严重问题列表（必须修改）
   - 轻微问题列表（建议修改）

7. **修改建议**
   - 优先修改项
   - 建议修改项
   - 整体优化建议

8. **下一步行动**
   - 通过：进入阶段六
   - 不通过：返回阶段四修改

## 通过标准

审查通过必须满足以下条件：

- ✅ 四大维度全部通过
- ✅ 零严重问题
- ✅ 轻微问题不超过5个

## 问题严重程度定义

### 严重问题
- 核心主题偏离
- 价值观矛盾
- 违反不可违背的创作原则
- 重大逻辑错误
- 结构严重缺失

### 轻微问题
- 个别章节与主题关联不够紧密
- 风格细节不够统一
- 次要情节逻辑不够严密
- 伏笔回收位置不够理想

## 审查流程

1. **准备阶段**
   - 打开验证报告
   - 打开大纲文档
   - 打开宪法文件

2. **逐维度检查**
   - 按照四大维度逐一检查
   - 记录所有发现的问题
   - 区分严重问题和轻微问题

3. **汇总问题**
   - 统计问题数量
   - 确定问题严重程度
   - 提供修改建议

4. **做出决定**
   - 如果通过：进入阶段六
   - 如果不通过：返回阶段四修改

## 下一步

### 如果审查通过

运行以下命令进入阶段六：

```bash
/writer:6-draft "<project-dir>" 1
```

### 如果审查不通过

1. 根据验证报告修改大纲
2. 修改完成后重新运行验证：
   ```bash
   /writer:5-validate "<project-dir>"
   ```

## 注意事项

1. **客观公正**: 审查应基于宪法文件的明确要求
2. **具体明确**: 所有问题都应具体指出位置
3. **建设性建议**: 不仅指出问题，还要提供修改建议
4. **严格标准**: 不要降低通过标准

## 相关命令

- `/writer:4-outline` - 返回阶段四修改大纲
- `/writer:6-draft` - 进入阶段六：分章节编写

## 技术细节

- **脚本位置**: `scripts/powershell/validate-outline.ps1`
- **模板位置**: `templates/validation-report-template.md`
- **输出目录**: `.writer/validation/`
- **编码**: UTF-8（无BOM）

